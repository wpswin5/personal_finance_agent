"use strict";(self.webpackChunkfinance_frontend=self.webpackChunkfinance_frontend||[]).push([[787],{147:(n,t,a)=>{a.d(t,{A:()=>c});var e=a(43),s=a(579);const c=n=>{let{token:t,plaidConnected:a,showTabs:c=!0}=n;const[o,i]=(0,e.useState)([]),[r,l]=(0,e.useState)([]),[d,h]=(0,e.useState)([]),[u,m]=(0,e.useState)(!1),[j,x]=(0,e.useState)(null),[f,p]=(0,e.useState)("connections"),v=async()=>{m(!0),x(null);try{const n=await fetch("http://localhost:8000/plaid/connections",{headers:{Authorization:"Bearer ".concat(t)}});if(!n.ok){if(404===n.status||204===n.status)return void h([]);throw new Error("Failed to fetch connections")}const a=await n.json();h(a||[])}catch(j){console.error("Error fetching connections:",j),x(j.message)}finally{m(!1)}};return(0,e.useEffect)(()=>{a&&t&&v()},[a,t]),(0,e.useEffect)(()=>{a&&t&&"accounts"===f?(async()=>{m(!0),x(null);try{const n=await fetch("http://localhost:8000/plaid/accounts",{headers:{Authorization:"Bearer ".concat(t)}});if(!n.ok){if(404===n.status||204===n.status)return void i([]);throw new Error("Failed to fetch accounts")}const a=await n.json();i(a.accounts||[])}catch(j){console.error("Error fetching accounts:",j),x(j.message)}finally{m(!1)}})():a&&t&&"transactions"===f&&(async()=>{m(!0),x(null);try{const n=await fetch("http://localhost:8000/plaid/transactions?count=50",{headers:{Authorization:"Bearer ".concat(t)}});if(!n.ok){if(404===n.status||204===n.status)return void l([]);throw new Error("Failed to fetch transactions")}const a=await n.json();l(a.transactions||[])}catch(j){console.error("Error fetching transactions:",j),x(j.message)}finally{m(!1)}})()},[a,t,f]),c?a?(0,s.jsxs)("div",{className:"plaid-data-container",children:[(0,s.jsxs)("div",{className:"tabs",children:[(0,s.jsx)("button",{className:"tab ".concat("connections"===f?"active":""),onClick:()=>p("connections"),children:"Connections"}),(0,s.jsx)("button",{className:"tab ".concat("accounts"===f?"active":""),onClick:()=>p("accounts"),children:"Accounts"}),(0,s.jsx)("button",{className:"tab ".concat("transactions"===f?"active":""),onClick:()=>p("transactions"),children:"Transactions"})]}),j&&(0,s.jsxs)("div",{className:"alert alert-danger",children:["Error: ",j]}),u&&(0,s.jsx)("div",{className:"loading",children:"Loading..."}),"connections"===f&&(0,s.jsxs)("div",{className:"connections-tab",children:[(0,s.jsx)("h3",{children:"Bank Connections"}),0===d.length?(0,s.jsx)("p",{children:"No bank connections found."}):(0,s.jsx)("div",{className:"connections-list",children:d.map(n=>(0,s.jsxs)("div",{className:"connection-card",children:[(0,s.jsxs)("div",{className:"connection-info",children:[(0,s.jsx)("h4",{children:n.institution_name||"Unknown Institution"}),(0,s.jsxs)("p",{children:["Item ID: ",n.item_id]}),(0,s.jsxs)("p",{children:["Connected: ",new Date(n.created_at).toLocaleDateString()]})]}),(0,s.jsx)("button",{className:"btn btn-danger btn-sm",onClick:()=>(async n=>{if(window.confirm("Are you sure you want to delete this connection?"))try{if(!(await fetch("http://localhost:8000/plaid/connections/".concat(n),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok)throw new Error("Failed to delete connection");v()}catch(j){console.error("Error deleting connection:",j),x(j.message)}})(n.id),children:"Delete"})]},n.id))})]}),"accounts"===f&&(0,s.jsxs)("div",{className:"accounts-tab",children:[(0,s.jsx)("h3",{children:"Accounts"}),0===o.length?(0,s.jsx)("p",{children:"No accounts found."}):(0,s.jsx)("div",{className:"accounts-list",children:o.map(n=>(0,s.jsxs)("div",{className:"account-card",children:[(0,s.jsx)("h4",{children:n.name}),(0,s.jsxs)("p",{children:["Type: ",n.type," ",n.subtype&&"(".concat(n.subtype,")")]}),(0,s.jsxs)("p",{children:["Balance: $",n.balance.toFixed(2)," ",n.currency]})]},n.account_id))})]}),"transactions"===f&&(0,s.jsxs)("div",{className:"transactions-tab",children:[(0,s.jsx)("h3",{children:"Recent Transactions"}),0===r.length?(0,s.jsx)("p",{children:"No transactions found."}):(0,s.jsx)("div",{className:"transactions-list",children:r.map(n=>(0,s.jsxs)("div",{className:"transaction-card",children:[(0,s.jsxs)("div",{className:"transaction-info",children:[(0,s.jsx)("h4",{children:n.name}),n.merchant_name&&(0,s.jsxs)("p",{children:["Merchant: ",n.merchant_name]}),(0,s.jsxs)("p",{children:["Date: ",new Date(n.date).toLocaleDateString()]}),(0,s.jsxs)("p",{children:["Category: ",n.category.join(", ")]}),n.pending&&(0,s.jsx)("span",{className:"badge",children:"Pending"})]}),(0,s.jsx)("div",{className:"transaction-amount",children:(0,s.jsxs)("span",{className:n.amount>0?"debit":"credit",children:["$",Math.abs(n.amount).toFixed(2)]})})]},n.transaction_id))})]})]}):(0,s.jsx)("div",{className:"alert alert-info",children:"Connect your bank account to view your financial data."}):null}},787:(n,t,a)=>{a.r(t),a.d(t,{default:()=>i});var e=a(43),s=a(447),c=a(147),o=a(579);const i=()=>{const{getAccessTokenSilently:n,isAuthenticated:t}=(0,s.WB)(),[a,i]=(0,e.useState)(null),[r,l]=(0,e.useState)(!0);return(0,e.useEffect)(()=>{(async()=>{if(t)try{const t=await n({audience:"https://fastapiexample.com",scope:"test:read"});i(t)}catch(a){console.error("Error getting access token:",a)}finally{l(!1)}})()},[t,n]),r?(0,o.jsx)("div",{className:"transactions-container",children:(0,o.jsx)("div",{className:"loading-spinner",children:"Loading..."})}):a?(0,o.jsxs)("div",{className:"transactions-container",children:[(0,o.jsxs)("div",{className:"transactions-header",children:[(0,o.jsx)("h1",{children:"Transactions"}),(0,o.jsx)("p",{children:"View and analyze your recent transactions"})]}),(0,o.jsx)("div",{className:"transactions-content",children:(0,o.jsx)(c.A,{token:a,plaidConnected:!0})})]}):(0,o.jsx)("div",{className:"transactions-container",children:(0,o.jsx)("div",{className:"error-message",children:"Unable to authenticate. Please try refreshing the page."})})}}}]);
//# sourceMappingURL=787.1f2f1dfb.chunk.js.map